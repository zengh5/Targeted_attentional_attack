borrowed from https://github.com/BorealisAI/advertorch
